
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-139058009-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Help on Python package (pygtftk) &#8212; gtftk 1.6.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The pygtftk.bwig.bw_coverage module" href="bwig_coverage.html" />
    <link rel="prev" title="Commands from section ‘miscellaneous’" href="miscellaneous.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bwig_coverage.html" title="The pygtftk.bwig.bw_coverage module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="miscellaneous.html" title="Commands from section ‘miscellaneous’"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">gtftk 1.6.2 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Help on Python package (pygtftk)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="help-on-python-package-pygtftk">
<h1>Help on Python package (pygtftk)<a class="headerlink" href="#help-on-python-package-pygtftk" title="Permalink to this headline">¶</a></h1>
<section id="module-pygtftk.gtf_interface">
<span id="the-gtf-class"></span><h2>The GTF class<a class="headerlink" href="#module-pygtftk.gtf_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of GTF object.</p>
<p>When using gtfk a GTF object methods may return:</p>
<blockquote>
<div><ul class="simple">
<li><p>a GTF object (a representation of a GTF file).</p></li>
<li><p>a TAB object (a representation of a tabulated file).</p></li>
<li><p>a FASTA object (a representation of a fasta file).</p></li>
</ul>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.gtf_interface.</span></span><span class="sig-name descname"><span class="pre">GTF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_ensembl_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF" title="Permalink to this definition">¶</a></dt>
<dd><p>An interface to a GTF file. This object returns a GTF, TAB
or FASTA object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.add_attr_column">
<span class="sig-name descname"><span class="pre">add_attr_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'new_key'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Simply add a new column of attribute/value to each line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> – a single column file with nrow(GTF_DATA) lines. File lines should be sorted according to the GTF_DATA object. Lines for which a new key should not be added should contain “?”.</p></li>
<li><p><strong>new_key</strong> – name of the novel key.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_col</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_column</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a_col</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">]</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">70</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.add_attr_from_dict">
<span class="sig-name descname"><span class="pre">add_attr_from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'new_key'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The comma-separated list of target feature. If None, all the features.</p></li>
<li><p><strong>key</strong> – The name of the key used for joining (e.g ‘transcript_id’).</p></li>
<li><p><strong>a_dict</strong> – key and values will be used to call add_attr_from_file.</p></li>
<li><p><strong>new_key</strong> – A name for the novel key.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_dict</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">a_dict</span><span class="o">=</span><span class="n">a_dict</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;exon_nb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id,exon_nb&quot;</span><span class="p">,</span> <span class="n">as_dict_of_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;G0006T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">b_dict</span><span class="p">[</span><span class="s1">&#39;G0006T001&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">b_dict</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.add_attr_from_file">
<span class="sig-name descname"><span class="pre">add_attr_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'new_key'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The comma-separated list of target feature. If None, all the features.</p></li>
<li><p><strong>key</strong> – The name of the key used for joining (i.e the key corresponding to value provided in the file).</p></li>
<li><p><strong>new_key</strong> – A name for the novel key.</p></li>
<li><p><strong>inputfile</strong> – A two column (e.g transcript_id and new value) file.</p></li>
<li><p><strong>has_header</strong> – Whether the file to join contains column names.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">join_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;join&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_file</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">inputfile</span><span class="o">=</span><span class="n">join_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_list</span> <span class="o">=</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.2322&#39;</span><span class="p">,</span> <span class="s1">&#39;0.999&#39;</span><span class="p">,</span> <span class="s1">&#39;0.5555&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">,</span> <span class="s1">&#39;exon_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ccds_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.add_attr_from_list">
<span class="sig-name descname"><span class="pre">add_attr_from_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'new_key'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_key_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The comma-separated list of target features. If None, all the features.</p></li>
<li><p><strong>key</strong> – The name of the key to use for joining (e.g ‘transcript_id’).</p></li>
<li><p><strong>key_value</strong> – The values for the key (e.g [‘tx_1’, ‘tx_2’,…,’tx_n’])</p></li>
<li><p><strong>new_key</strong> – A name for the novel key.</p></li>
<li><p><strong>new_key_value</strong> – A name for the novel key (e.g [‘val_tx_1’, ‘val_tx_2’,…,’val_tx_n’]).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;G0001&quot;</span><span class="p">,</span> <span class="s2">&quot;G0002&quot;</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;0.8&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;G0002&quot;</span><span class="p">,</span> <span class="s2">&quot;G0001&quot;</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;0.8&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;coding_pot&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_value</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">=</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="n">key_value</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key_value</span><span class="p">))]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span>  <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">,</span> <span class="s1">&#39;exon_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ccds_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.add_attr_from_matrix_file">
<span class="sig-name descname"><span class="pre">add_attr_from_matrix_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_from_matrix_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Add key/value pairs to the GTF file. Expect a matrix with row names as target keys column names as novel key and each cell as value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The comma-separated list of target features. If None, all the features.</p></li>
<li><p><strong>key</strong> – The name of the key to use for joining (i.e the key corresponding to value provided in the file).</p></li>
<li><p><strong>inputfile</strong> – A two column (e.g transcript_id and new value) file.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">join_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;join_mat&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_matrix_file</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">inputfile</span><span class="o">=</span><span class="n">join_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;S1&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.2322&#39;</span><span class="p">,</span> <span class="s1">&#39;0.999&#39;</span><span class="p">,</span> <span class="s1">&#39;0.5555&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;S2&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6&#39;</span><span class="p">,</span> <span class="s1">&#39;0.7&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s1">&#39;S1,S2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">,</span> <span class="s1">&#39;exon_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ccds_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.add_attr_to_pos">
<span class="sig-name descname"><span class="pre">add_attr_to_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'new_key'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_attr_to_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Simply add a new column of attribute/value to specific lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> – a two column file. First column contains the position/line (zero-based numbering). Second, the value to be added for ‘new_key’.</p></li>
<li><p><strong>new_key</strong> – name of the novel key.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_col</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;tab&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_to_pos</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a_col</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;AAA&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BBB&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CCC&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.add_exon_number">
<span class="sig-name descname"><span class="pre">add_exon_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exon_nbr'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_exon_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Add exon number to exons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The key name to use for exon number.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_exon_number</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004T002&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;exon_nbr&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span>  <span class="n">a_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0003T001&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;exon_nbr&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span>  <span class="n">a_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.add_prefix">
<span class="sig-name descname"><span class="pre">add_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">txt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.add_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a prefix to an attribute value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The target features (default to all).</p></li>
<li><p><strong>key</strong> – The target key.</p></li>
<li><p><strong>txt</strong> – The string to be added as a prefix.</p></li>
<li><p><strong>suffix</strong> – If True append txt string as a suffix.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">txt</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">txt</span><span class="o">=</span><span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_list</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.convert_to_ensembl">
<span class="sig-name descname"><span class="pre">convert_to_ensembl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">check_gene_chr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.convert_to_ensembl" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a GTF file to ensembl format. This method will add gene
and transcript features if not encountered in the GTF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>check_gene_chr</strong> – By default the function raise an error if several chromosomes are associated with the same gene_id.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene,transcript&quot;</span><span class="p">,</span> <span class="n">invert_match</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">convert_to_ensembl</span><span class="p">())</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.del_attr">
<span class="sig-name descname"><span class="pre">del_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.del_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an attributes from the GTF file..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The target feature.</p></li>
<li><p><strong>keys</strong> – comma-separated list or list of target keys.</p></li>
<li><p><strong>force</strong> – If True, transcript_id and gene_id can be deleted.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">del_attr</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="s2">&quot;gene_id,exon_id,ccds_id&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.eval_numeric">
<span class="sig-name descname"><span class="pre">eval_numeric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bool_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">na_omit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('.',</span> <span class="pre">'?')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.eval_numeric" title="Permalink to this definition">¶</a></dt>
<dd><p>Test numeric values. Select lines using a boolean operation on attributes.
The boolean expression must contain attributes enclosed with braces.
Example: “cDNA_length &gt; 200 and tx_genomic_length &gt; 2000”.
Note that one can refers to the name of the first columns of the gtf using e.g:
start, end, score or frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bool_exp</strong> – A boolean test.</p></li>
<li><p><strong>na_omit</strong> – Any line for which one of the tested value is in this list wont be evaluated (e.g. (“.”, “?”)).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;G0001T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0002T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0003T001&quot;</span><span class="p">,</span><span class="s2">&quot;G0004T001&quot;</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;10&quot;</span><span class="p">,</span><span class="s2">&quot;11&quot;</span><span class="p">,</span><span class="s2">&quot;20&quot;</span><span class="p">,</span><span class="s2">&quot;40&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_list</span> <span class="o">=</span> <span class="n">b_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;test &gt; 2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s1">&#39;test &gt; 0.1e2 and start &lt; 180 and start &gt;= 50&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s1">&#39;test &gt; 0.1e2 and start &lt; 180 and start &gt; 50&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s1">&#39;test &gt; 0.1e2&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;mini_real&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf.gz&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s1">&#39;feature&#39;</span><span class="p">,</span><span class="s1">&#39;transcript&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;score == 0&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;1001145&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;start == 1001145&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;1001145&quot;</span><span class="p">,</span> <span class="n">invert_match</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;start != 1001145&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s2">&quot;54801291&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;end == 54801291&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;end == 54801291 and start == 53802771&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;end == 54801291 and (start == 53802771 or start == 53806156)&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">eval_numeric</span><span class="p">(</span><span class="s2">&quot;phase &gt; 0 and phase &lt; 2&quot;</span><span class="p">,</span> <span class="n">na_omit</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.extract_data">
<span class="sig-name descname"><span class="pre">extract_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_based</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_na</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict_of_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict_of_lists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict_of_merged_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hide_undef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_list_of_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.extract_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract attribute values into containers of various types. Note that in case dict are requested, keys are force to no_na.</p>
<p>Note: no_na, hide_undef, nr, zero_based are not applied in case a tab object is returned (default).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> – The name of the basic or extended attributes.</p></li>
<li><p><strong>as_list</strong> – if true returns values for the first requested key as a list.</p></li>
<li><p><strong>no_na</strong> – Discard ‘.’ (i.e undefined value).</p></li>
<li><p><strong>as_dict</strong> – if true returns a dict (where the key corresponds to values for the first requested key and values are set to 1). Note that ‘.’ won’t be set as a key (no need to use no_na).</p></li>
<li><p><strong>as_dict_of_values</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to value encountered for the second requested key).</p></li>
<li><p><strong>as_dict_of_lists</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to the last encountered list of other elements).</p></li>
<li><p><strong>as_dict_of_merged_list</strong> – if true returns a dict (where the key corresponds to values for the first requested key and the value to the list of other elements encountered throughout any line).</p></li>
<li><p><strong>as_list_of_list</strong> – if True returns a list for each line.</p></li>
<li><p><strong>nr</strong> – in case a as_list or as_list_of_list is chosen, return a non redondant list.</p></li>
<li><p><strong>hide_undef</strong> – if hide_undef, then records for which the key does not exists (value = “?”) are discarded.</p></li>
<li><p><strong>zero_based</strong> – If set to True, the start position will be start-1.</p></li>
<li><p><strong>default_val</strong> – The default value for the dict if as_dict is chosen.</p></li>
</ul>
</dd>
</dl>
<p>Note: hide_undef and no_na are not supported when a TAB object is returned (default).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id,transcript_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_tab</span><span class="o">.</span><span class="n">ncols</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_tab</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">no_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">no_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span><span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;bla&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid&quot;</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list_of_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid,start&quot;</span><span class="p">,</span> <span class="n">as_list_of_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="mi">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.extract_data_iter_list">
<span class="sig-name descname"><span class="pre">extract_data_iter_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_based</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.extract_data_iter_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract attributes of any type and returns an iterator of lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> – The name of the basic or extended attributes.</p></li>
<li><p><strong>zero_based</strong> – If set to True, the start position will be start-1.</p></li>
<li><p><strong>nr</strong> – if True, return a list with non redundant items.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;125&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">,</span> <span class="n">zero_based</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;124&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">])</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gen</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data_iter_list</span><span class="p">(</span><span class="s2">&quot;start,gene_id&quot;</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">])</span> <span class="o">==</span> <span class="mi">26</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_3p_end">
<span class="sig-name descname"><span class="pre">get_3p_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">more_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explicit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the 3’ coordinates of selected
features (Bed6 format) or a dict (zero-based coordinate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat_type</strong> – The feature type.</p></li>
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a list).</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>as_dict</strong> – return the result as a dictionnary.</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
<li><p><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;exon_id&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;exon_id&quot;</span><span class="p">],</span> <span class="n">explicit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bed</span><span class="p">:</span> <span class="k">break</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;gene_id=G0001|exon_id=G0001T002E001&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_5p_end">
<span class="sig-name descname"><span class="pre">get_5p_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">more_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_based</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explicit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the 5’ coordinates of selected
features (Bed6 format) or a dict (zero-based coordinate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat_type</strong> – The feature type.</p></li>
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a tuple).</p></li>
<li><p><strong>as_dict</strong> – return the result as a dictionnary.</p></li>
<li><p><strong>one_based</strong> – if as_dict is requested, return coordinates in on-based format.</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
<li><p><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exon_id&quot;</span><span class="p">],</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exon_id&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript_id&quot;</span><span class="p">],</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_id&quot;</span><span class="p">],</span> <span class="n">explicit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bed</span><span class="p">:</span> <span class="k">break</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;transcript_id=G0001T002|gene_id=G0001&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_attr_list">
<span class="sig-name descname"><span class="pre">get_attr_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_basic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_attr_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of possible attributes from a GTF file..</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_basic</strong> – add basic attributes to the list. Won’t work if as_dict is True.</p></li>
<li><p><strong>as_dict</strong> – If True, returns a dict with the attribute names as key and number of occurence as values.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()])</span> <span class="o">==</span> <span class="s1">&#39;gtec&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_attr_value_list">
<span class="sig-name descname"><span class="pre">get_attr_value_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_attr_value_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of possible values taken by an attributes from a GTF file..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key/attribute name to use.</p></li>
<li><p><strong>count</strong> – whether the number of occurences should be also returned (returns a list of list).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0001T001&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_attr_value_list</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0010T001&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_chroms">
<span class="sig-name descname"><span class="pre">get_chroms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_chroms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the chomosome/sequence ID from the GTF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong> – True to get a non redondant list.</p></li>
<li><p><strong>as_dict</strong> – True to get info as a dict.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_chr</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_chroms</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_chr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_chr</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">get_chroms</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_chr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_feature_list">
<span class="sig-name descname"><span class="pre">get_feature_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_feature_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nr</strong> – True to get a non redondant list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_list</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_feat</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_list</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_feat</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_feature_size">
<span class="sig-name descname"><span class="pre">get_feature_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ft_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gene'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_feature_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns feature size as a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ft_type</strong> – The feature type (3rd column). Could be gene, transcript, exon, CDS…</p></li>
<li><p><strong>feat_id</strong> – the string used as feature identifier in the GTF. Could be gene_id, transcript_id, exon_id, CDS_id… By default it is computed as ft_type + ‘_id’</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">get_feature_size</span><span class="p">(</span><span class="s2">&quot;exon&quot;</span><span class="p">,</span> <span class="s2">&quot;exon_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_gn_ids">
<span class="sig-name descname"><span class="pre">get_gn_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all gene ids from the GTF file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nr</strong> – True to get a non redondant list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span><span class="s2">&quot;G0001,G0002&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_gn_strand">
<span class="sig-name descname"><span class="pre">get_gn_strand</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with gene IDs as keys and strands as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_strand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0005&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0006&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_gn_to_tx">
<span class="sig-name descname"><span class="pre">get_gn_to_tx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ordered_5p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict_of_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gn_to_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with genes as keys and the list of their associated transcripts
as values.</p>
<p>params ordered_5p: If True, returns transcript list ordered based on their TSS coordinates (5’ to 3’). For ties, transcript name are randomly picked.
params as_dict_of_dict: If True, returns a dict of dict that maps gene_id to transcript_id and transcript_id to TSS numbering (1 for most 5’, then 2…). For transcripts having the same TSSs, the tss number will be the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;mini_real&quot;</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf.gz&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_2_tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_to_tx</span><span class="p">(</span><span class="n">ordered_5p</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148337&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000372948&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000634901&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000634501&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148339&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000373068&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000373069&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000373066&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000148339&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">:]</span>  <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;ENST00000472769&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000445012&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000466983&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_2_tx</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_to_tx</span><span class="p">(</span><span class="n">as_dict_of_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000587658&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000587559&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000430256&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000284006&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000153885&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000589786&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000407193&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000401695&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000164587&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000519690&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000105483&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000517510&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gn_2_tx</span><span class="p">[</span><span class="s1">&#39;ENSG00000105483&#39;</span><span class="p">][</span><span class="s1">&#39;ENST00000520007&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_gname_to_tx">
<span class="sig-name descname"><span class="pre">get_gname_to_tx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_gname_to_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with gene names as keys and the list of their associated transcripts
as values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_intergenic">
<span class="sig-name descname"><span class="pre">get_intergenic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chrom_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chr_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_intergenic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the intergenic regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chrom_file</strong> – file object pointing to a tabulated two-columns file. Chromosomes as column 1 and their sizes as column 2 (default: None)</p></li>
<li><p><strong>upstream</strong> – Extend transcript coordinates in 5’ direction.</p></li>
<li><p><strong>downstream</strong> – Extend transcript coordinates in 3’ direction.</p></li>
<li><p><strong>chr_list</strong> – a list of chromosome to restrict intergenic regions.</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chr_info_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;chromInfo&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chr_info_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">chr_info_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_intergenic</span><span class="p">(</span><span class="n">chrom_file</span><span class="o">=</span><span class="n">chr_info_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_introns">
<span class="sig-name descname"><span class="pre">get_introns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">by_transcript</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('transcript_id',</span> <span class="pre">'gene_id')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intron_nb_in_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_name_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_introns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the intronic regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>by_transcript</strong> – If false (default), merged genic regions with no exonic overlap are returned. Otherwise, the intronic regions corresponding to each transcript are returned (may contain exonic overlap).</p></li>
<li><p><strong>name</strong> – The list of ids that should be part of the 4th column of the bed file (if by_transcript is chosen).</p></li>
<li><p><strong>sep</strong> – The separator to be used for the name (if by_transcript is chosen).</p></li>
<li><p><strong>intron_nb_in_name</strong> – by default the intron number is added to the score column. If selected, write this information in the ‘name’ column of the bed file.</p></li>
<li><p><strong>feat_name</strong> – add the feature name (‘intron’) in the name column.</p></li>
<li><p><strong>feat_name_last</strong> – put feat_name in last position (but before intron_nb_in_name).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_introns</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_midpoints">
<span class="sig-name descname"><span class="pre">get_midpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('transcript_id',</span> <span class="pre">'gene_id')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_midpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bedtools object containing the midpoints of features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id’)”.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_midpoints</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_sequences">
<span class="sig-name descname"><span class="pre">get_sequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genome</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_sequences" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Returns a FASTA object from which various sequences can be retrieved.</p>
<dl class="field-list simple">
<dt class="field-odd">param genome</dt>
<dd class="field-odd"><p>The genome in fasta file.</p>
</dd>
<dt class="field-even">param intron</dt>
<dd class="field-even"><p>Set to True to get also intronic regions. Required for some methods of the FASTA object.</p>
</dd>
<dt class="field-odd">param rev_comp</dt>
<dd class="field-odd"><p>By default sequence for genes on minus strand are         reversed-complemented. Set to False to avoid default behaviour.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># No intron, reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_fa</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0001_NA_G0001T001_chr1:125-138_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cccccgttacgtag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_RC_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;catgcgct&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># No intron, no reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">rev_comp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0001_NA_G0001T001_chr1:125-138_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cccccgttacgtag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;agcgcatg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+_mRNA&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Intron and Reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-_RC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;catatggtgcgct&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctcaggggcg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Intron and no Reverse-complement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rev_comp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="p">:</span> <span class="n">a_dict</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0008_NA_G0008T001_chr1:210-222_-&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;agcgcaccatatg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_dict</span><span class="p">[</span><span class="s1">&#39;&gt;G0004_NA_G0004T001_chr1:65-76_+&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atctcaggggcg&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_transcript_size">
<span class="sig-name descname"><span class="pre">get_transcript_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_intron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_transcript_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript_id as keys and their mature RNA length
(i.e exon only) of each transcript.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>with_intron</strong> – If True, add intronic regions.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_path</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_dict</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">get_transcript_size</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">size_dict</span><span class="p">[</span><span class="s2">&quot;G0008T001&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size_dict</span> <span class="o">=</span> <span class="n">gtf</span><span class="o">.</span><span class="n">get_transcript_size</span><span class="p">(</span><span class="n">with_intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">size_dict</span><span class="p">[</span><span class="s2">&quot;G0008T001&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_tss">
<span class="sig-name descname"><span class="pre">get_tss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">more_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_based</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explicit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tss" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the TSSs (Bed6 format) or a dict
(zero-based coordinate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a tuple).</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>as_dict</strong> – return the result as a dictionnary.</p></li>
<li><p><strong>one_based</strong> – if as_dict is requested, return coordinates in on-based format.</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
<li><p><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tss</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_tts">
<span class="sig-name descname"><span class="pre">get_tts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">more_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explicit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object containing the TTSs (Bed6 format) or a dict
(zero-based coordinate).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The key that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>as_dict</strong> – return the result as a dictionnary.</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a list).</p></li>
<li><p><strong>feature_name</strong> – A feature name to be added to the 4th column.</p></li>
<li><p><strong>explicit</strong> – Write explicitly the key name in the 4th column (e.g transcript_id=NM123|gene_name=AGENE|…).</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bed</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_tx_ids">
<span class="sig-name descname"><span class="pre">get_tx_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all transcript_id from the GTF file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nr</strong> – True to get a non redondant list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span><span class="s2">&quot;G0001T002,G0001T001,G0003T001&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_ids</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_tx_strand">
<span class="sig-name descname"><span class="pre">get_tx_strand</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_strand" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript IDs as keys and strands as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_tx_strand</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0007T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0001T002&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0009T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">strands</span><span class="p">[</span><span class="s1">&#39;G0008T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_tx_to_gn">
<span class="sig-name descname"><span class="pre">get_tx_to_gn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_to_gn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcripts IDs as keys and gene IDs as values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.get_tx_to_gname">
<span class="sig-name descname"><span class="pre">get_tx_to_gname</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.get_tx_to_gname" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict with transcript IDs as keys and gene names as values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.head">
<span class="sig-name descname"><span class="pre">head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.head" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the nb first lines of the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb</strong> – The number of line to display.</p></li>
<li><p><strong>returned</strong> – If True, don’t print but returns the message.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.is_defined">
<span class="sig-name descname"><span class="pre">is_defined</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.is_defined" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a numpy array representation of a GTF attribute indicating, for each line, whether the key is defined
(i.e. exists). In pygtftk, values for undefined keys are ‘?’. So in other words this function tests whether
each value differs from ‘?’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of booleans.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">is_defined</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_val</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_ids</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">get_gn_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">add_attr_from_list</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="n">key_value</span><span class="o">=</span><span class="p">(</span><span class="n">gn_ids</span><span class="p">),</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">new_key_value</span><span class="o">=</span><span class="n">gn_val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn_feat</span> <span class="o">=</span> <span class="n">b_gtf</span><span class="p">[</span><span class="n">b_gtf</span><span class="o">.</span><span class="n">feature</span> <span class="o">==</span> <span class="s1">&#39;gene&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">sum</span><span class="p">((</span><span class="o">~</span><span class="n">gn_feat</span><span class="o">.</span><span class="n">is_defined</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="n">gn_feat</span><span class="o">.</span><span class="n">is_set</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.is_set">
<span class="sig-name descname"><span class="pre">is_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.is_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a numpy array representation of a GTF attribute indicating, for each line, whether the key is set
(i.e. is defined with value ‘.’). In pygtftk, values for unset keys are ‘.’. So in other words this function
tests whether each value for the input key are set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of booleans.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">is_defined</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">60</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.merge_attr">
<span class="sig-name descname"><span class="pre">merge_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gene_id,transcript_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gn_tx_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.merge_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a set of source keys (e.g gene_id and transcript_id) into a destination attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> – The target features.</p></li>
<li><p><strong>keys</strong> – The source keys.</p></li>
<li><p><strong>new_key</strong> – The destination key.</p></li>
<li><p><strong>sep</strong> – The separator.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">merge_attr</span><span class="p">(</span><span class="n">feat</span><span class="o">=</span><span class="s2">&quot;exon,transcript,CDS&quot;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="s2">&quot;gene_id,transcript_id&quot;</span><span class="p">,</span> <span class="n">new_key</span><span class="o">=</span><span class="s2">&quot;merge&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;merge&quot;</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;G0001|G0001T002&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INFO'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.message" title="Permalink to this definition">¶</a></dt>
<dd><p>A processing message whose verbosity is adapted based on pygtftk.utils.VERBOSITY.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pygtftk.utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pygtftk</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pygtftk</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pygtftk</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pygtftk</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.nb_exons">
<span class="sig-name descname"><span class="pre">nb_exons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.nb_exons" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict with transcript as key and number of exon as value.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nb_ex</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nb_ex</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0006T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0004T002&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0004T002&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0005T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple_04&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nb_ex</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nb_exons</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">nb_ex</span><span class="p">[</span><span class="s1">&#39;G0004T001&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.nrow">
<span class="sig-name descname"><span class="pre">nrow</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.nrow" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of lines enclosed in the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;gene&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;CDS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">nrow</span><span class="p">()</span> <span class="o">==</span> <span class="mi">20</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_5p_transcript">
<span class="sig-name descname"><span class="pre">select_5p_transcript</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_5p_transcript" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the most 5’ transcript of each gene. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_by_key">
<span class="sig-name descname"><span class="pre">select_by_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_with_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_na</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Select lines from a GTF based i) on attributes and values 2) on
feature type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key/attribute name to use for selection.</p></li>
<li><p><strong>value</strong> – Value for that key/attribute.</p></li>
<li><p><strong>invert_match</strong> – Boolean. Select lines that do not match that key and value.</p></li>
<li><p><strong>file_with_values</strong> – A file containing values (one column).</p></li>
<li><p><strong>col</strong> – The column number (one-based) that contains the values in the file.</p></li>
<li><p><strong>no_na</strong> – If invert_match is True then returns only record for which the value is defined.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;G0004T002&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_gtf</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_gtf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;exon&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">25</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_by_loc">
<span class="sig-name descname"><span class="pre">select_by_loc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chr_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Select lines from a GTF based on genomic location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chr_str</strong> – A comma-separated list of chromosomes.</p></li>
<li><p><strong>start_str</strong> – A comma-separated list of starts.</p></li>
<li><p><strong>end_str</strong> – A comma-separated list of ends.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_loc</span><span class="p">(</span><span class="s2">&quot;chr1&quot;</span><span class="p">,</span> <span class="s2">&quot;125&quot;</span><span class="p">,</span> <span class="s2">&quot;138&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_by_max_exon_nb">
<span class="sig-name descname"><span class="pre">select_by_max_exon_nb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_max_exon_nb" title="Permalink to this definition">¶</a></dt>
<dd><p>For each gene select the transcript with the highest number of exons. If ties, select the first encountered.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple_04&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_max_exon_nb</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hide_undef</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0005T001&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0004T002&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;G0006T002&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_by_number_of_exons">
<span class="sig-name descname"><span class="pre">select_by_number_of_exons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_number_of_exons" title="Permalink to this definition">¶</a></dt>
<dd><p>Select transcript from a GTF based on the number of exons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min</strong> – Minimum number of exons.</p></li>
<li><p><strong>max</strong> – Maximum number of exons.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_number_of_exons</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_by_positions">
<span class="sig-name descname"><span class="pre">select_by_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a set of lines by position. Numbering zero-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pos</strong> – </p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;gene&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">select_by_positions</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;CDS&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_by_regexp">
<span class="sig-name descname"><span class="pre">select_by_regexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regexp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_regexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns lines for which key value match a regular expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key/attribute name to use for selection.</p></li>
<li><p><strong>regexp</strong> – the regular expression</p></li>
<li><p><strong>invert_match</strong> – Select lines are those that do not match.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_list</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00[012]+T00[12]$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b_list</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;G0001T002&#39;</span><span class="p">,</span> <span class="s1">&#39;G0001T001&#39;</span><span class="p">,</span> <span class="s1">&#39;G0002T001&#39;</span><span class="p">,</span> <span class="s1">&#39;G0010T001&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00\d+T00\d+$&quot;</span><span class="p">))</span><span class="o">==</span><span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_regexp</span><span class="p">(</span><span class="s2">&quot;transcript_id&quot;</span><span class="p">,</span> <span class="s2">&quot;^G00\d+T00.*2$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_tx_ids</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">==</span><span class="mi">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_by_transcript_size">
<span class="sig-name descname"><span class="pre">select_by_transcript_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_by_transcript_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Select ‘mature/spliced transcript by size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min</strong> – Minimum size for the feature.</p></li>
<li><p><strong>max</strong> – Maximum size for the feature.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx_kept</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_transcript_size</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx_kept</span><span class="p">)</span> <span class="o">==</span> <span class="mi">45</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_longuest_transcripts">
<span class="sig-name descname"><span class="pre">select_longuest_transcripts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_longuest_transcripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the longuest transcript of each gene.
The “gene” rows are returned in the results. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.select_shortest_transcripts">
<span class="sig-name descname"><span class="pre">select_shortest_transcripts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.select_shortest_transcripts" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the shortest transcript of each gene. Note that the genomic
boundaries for each gene could differ from that displayed by its
associated transcripts. The gene features may be subsequently deleted
using select_by_key.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.tail">
<span class="sig-name descname"><span class="pre">tail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.tail" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the nb last lines of the GTF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb</strong> – The number of line to display.</p></li>
<li><p><strong>returned</strong> – If True, don’t print but returns the message.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.to_bed">
<span class="sig-name descname"><span class="pre">to_bed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gene_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_feature_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">more_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.to_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Bedtool object (Bed6 format).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The keys that should be used to computed the ‘name’ column (a tuple).</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a list).</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>add_feature_type</strong> – Add the feature type to the name.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_bo</span><span class="o">.</span><span class="n">field_count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_bo</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_bo</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">select_by_key</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;gene_id&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript_id&#39;</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_bo</span><span class="p">:</span> <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_chr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gc_off</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.write" title="Permalink to this definition">¶</a></dt>
<dd><p>write the gtf to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> – A file object where the GTF has to be written.</p></li>
<li><p><strong>add_chr</strong> – whether to add ‘chr’ prefix to seqid before printing.</p></li>
<li><p><strong>gc_off</strong> – If True, shutdown the garbage collector before printing to avoid passing through free_gtf_data which can be time-consuming.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">b_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.gtf_interface.GTF.write_bed">
<span class="sig-name descname"><span class="pre">write_bed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gene_id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_chr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">more_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.gtf_interface.GTF.write_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a GTF file in BED format. This function uses a direct call to the C interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputfile</strong> – The outputfilename.</p></li>
<li><p><strong>name</strong> – The keys that should be used to computed the ‘name’ column (a tuple).</p></li>
<li><p><strong>more_name</strong> – Additional text to add to the name (a list).</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pygtftk.fasta_interface">
<span id="the-fasta-class"></span><h2>The FASTA class<a class="headerlink" href="#module-pygtftk.fasta_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of the FASTA object (may be returned by GTF object methods).</p>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.fasta_interface.FASTA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.fasta_interface.</span></span><span class="sig-name descname"><span class="pre">FASTA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev_comp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representation of a fasta file connection. A end product
from a GTF object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.fasta_interface.FASTA.transcript_as_bioseq_records">
<span class="sig-name descname"><span class="pre">transcript_as_bioseq_records</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.transcript_as_bioseq_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over transcript sequences with or without intron depending on arguments provided to GTF.get_sequences(). Returns objects of class Bio.SeqRecord.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_fa</span><span class="o">.</span><span class="n">transcript_as_bioseq_records</span><span class="p">():</span> <span class="n">a_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rec</span> <span class="o">=</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.fasta_interface.FASTA.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.fasta_interface.FASTA.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the sequences to a fasta file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>outputfile</strong> – Output file (file object).</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;gtf&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">genome_fa</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="s2">&quot;fa&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">get_sequences</span><span class="p">(</span><span class="n">genome_fa</span><span class="p">,</span> <span class="n">intron</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_fa</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="o">==</span> <span class="mi">30</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-pygtftk.tab_interface">
<span id="the-tab-class"></span><h2>The TAB class<a class="headerlink" href="#module-pygtftk.tab_interface" title="Permalink to this headline">¶</a></h2>
<p>Class declaration of the TAB object (may be returned by a GTF instance).</p>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.tab_interface.TAB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.tab_interface.</span></span><span class="sig-name descname"><span class="pre">TAB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dll</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representation of a tabulated matrix. An end product
from a GTF object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.tab_interface.TAB.as_data_frame">
<span class="sig-name descname"><span class="pre">as_data_frame</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.as_data_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the TAB object into a dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id,start&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_tab</span><span class="o">.</span><span class="n">as_data_frame</span><span class="p">()[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.tab_interface.TAB.as_simple_list">
<span class="sig-name descname"><span class="pre">as_simple_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.as_simple_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the selected column of a TAB object into a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>which_col</strong> – The column number.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)[(</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span> <span class="s2">&quot;gene&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;seqid&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a_tab</span><span class="o">.</span><span class="n">as_simple_list</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.tab_interface.TAB.iter_as_list">
<span class="sig-name descname"><span class="pre">iter_as_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.iter_as_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the TAB object and return a list of self.nb_columns elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;gene_id,start&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">a_tab</span><span class="o">.</span><span class="n">iter_as_list</span><span class="p">())</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">a_tab</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.tab_interface.TAB.iterate_with_header">
<span class="sig-name descname"><span class="pre">iterate_with_header</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.iterate_with_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over FieldSets. The first line contains the field names.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">a_gtf</span><span class="o">.</span><span class="n">iterate_with_header</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;seqid&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a_gtf</span><span class="o">.</span><span class="n">iterate_with_header</span><span class="p">():</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;CDS_G0010T001&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.tab_interface.TAB.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.tab_interface.TAB.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a tab object to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span> <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">simple_nb_column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;transcript_id,gene_id&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tab</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_nb_column</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-pygtftk.Line">
<span id="the-line-module"></span><h2>The Line module<a class="headerlink" href="#module-pygtftk.Line" title="Permalink to this headline">¶</a></h2>
<p>This section contains representation of GTF, TAB and FASTA records (i.e, ‘lines’).
When iterating over GTF, TAB or FASTA instances, the following objects will be
returned respectively:</p>
<blockquote>
<div><ul class="simple">
<li><p>Feature</p></li>
<li><p>FieldSet</p></li>
<li><p>FastaSequence</p></li>
</ul>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.Line.FastaSequence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.Line.</span></span><span class="sig-name descname"><span class="pre">FastaSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transcript'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representating a fasta file line.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.FastaSequence.format">
<span class="sig-name descname"><span class="pre">format</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a formated fasta sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="kn">import</span> <span class="n">FastaSequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FastaSequence</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&gt;bla&#39;</span><span class="p">,</span> <span class="s1">&#39;AATACAGAGAT&#39;</span><span class="p">,</span><span class="s1">&#39;chr21&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA&#39;</span><span class="p">,</span> <span class="s1">&#39;NM123&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="s1">&#39;AATACAGAGAT&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="s1">&#39;&gt;bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.FastaSequence.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FastaSequence.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write FastaSequence to a file or stdout (if file is None).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="kn">import</span> <span class="n">FastaSequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FastaSequence</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&gt;bla&#39;</span><span class="p">,</span> <span class="s1">&#39;AATACAGAGAT&#39;</span><span class="p">,</span><span class="s1">&#39;chr21&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;BLA&#39;</span><span class="p">,</span> <span class="s1">&#39;NM123&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.Line.Feature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.Line.</span></span><span class="sig-name descname"><span class="pre">Feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representation of a genomic feature. Corresponds to a GTF line.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.add_attr">
<span class="sig-name descname"><span class="pre">add_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.add_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an attribute to the Feature instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">add_attr</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.add_attr_and_write">
<span class="sig-name descname"><span class="pre">add_attr_and_write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.add_attr_and_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a key/attribute record and write to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">add_attr_and_write</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.gtf_interface</span> <span class="kn">import</span>  <span class="n">GTF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gtf</span> <span class="o">=</span> <span class="n">GTF</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">check_ensembl_format</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gtf</span><span class="o">.</span><span class="n">extract_data</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">as_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.format">
<span class="sig-name descname"><span class="pre">format</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Feature as a string in gtf file format. Typically
to write to a gtf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">feat</span><span class="o">.</span><span class="n">format</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">))</span> <span class="o">==</span> <span class="mi">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.format_tab">
<span class="sig-name descname"><span class="pre">format_tab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.format_tab" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Feature as a string in tabulated format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attr_list</strong> – the attributes names.</p></li>
<li><p><strong>sep</strong> – separator.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">TAB</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">,</span> <span class="s1">&#39;transcript&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;g1t1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">format_tab</span><span class="p">(</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.from_list">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Feature object from a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Params alist</dt>
<dd class="field-odd"><p>a list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="kn">import</span> <span class="n">Feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span><span class="s1">&#39;transcript&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g1t1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alist</span> <span class="o">+=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">d</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">alist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">attr</span><span class="p">[</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g1t1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">attr</span><span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.get_3p_end">
<span class="sig-name descname"><span class="pre">get_3p_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 3’ end of the feature. Returns ‘end’ if on ‘+’ strand ‘start’
otherwise (one based).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_3p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">200</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.get_5p_end">
<span class="sig-name descname"><span class="pre">get_5p_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 5’ end of the feature. Returns ‘start’ if on ‘+’ strand ‘end’
otherwise (one based).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="kn">import</span> <span class="n">Feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;pygtftk&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_feat</span> <span class="o">=</span> <span class="n">Feature</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;pygtftk&#39;</span><span class="p">,</span> <span class="s1">&#39;exon&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a_feat</span><span class="o">.</span><span class="n">get_5p_end</span><span class="p">()</span> <span class="o">==</span> <span class="mi">100</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.get_attr_names">
<span class="sig-name descname"><span class="pre">get_attr_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_attr_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the attribute names from the Feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;transcript_id&#39;</span> <span class="ow">in</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_names</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;gene_id&#39;</span> <span class="ow">in</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_names</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.get_attr_value">
<span class="sig-name descname"><span class="pre">get_attr_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upon_none</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'continue'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_attr_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of a basic or extended attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attr_name</strong> – Name of the attribute/key.</p></li>
<li><p><strong>upon_none</strong> – Wether we should ‘continue’, ‘raise’ an error or         ‘set_na’.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;transcript_id&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;g1t1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;chrom&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">,</span> <span class="n">upon_none</span><span class="o">=</span><span class="s1">&#39;continue&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_attr_value</span><span class="p">(</span><span class="s1">&#39;bla&#39;</span><span class="p">,</span> <span class="n">upon_none</span><span class="o">=</span><span class="s1">&#39;set_na&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.get_gn_id">
<span class="sig-name descname"><span class="pre">get_gn_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_gn_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get value for ‘gene_id’ attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_gn_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;g1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.get_tx_id">
<span class="sig-name descname"><span class="pre">get_tx_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.get_tx_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get value for ‘transcript_id’ attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_tx_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;g1t1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.set_attr">
<span class="sig-name descname"><span class="pre">set_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upon_none</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'continue'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.set_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an attribute value of the Feature instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key.</p></li>
<li><p><strong>val</strong> – The value.</p></li>
<li><p><strong>upon_none</strong> – Wether we should ‘continue’, ‘raise’ an error or ‘set_na’.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="s2">&quot;bla&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">feat</span><span class="o">.</span><span class="n">get_gn_id</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write Feature to a file or stdout (if file is ‘-‘).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.write_bed">
<span class="sig-name descname"><span class="pre">write_bed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bed6'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the Feature instance in bed format (Zero-based).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – A string to use as name (Column 4).</p></li>
<li><p><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</p></li>
<li><p><strong>outputfile</strong> – the file object were data should be printed.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;foo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.write_bed_3p_end">
<span class="sig-name descname"><span class="pre">write_bed_3p_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bed6'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed_3p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the 3p end coordinates of feature in bed format (Zero-based).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputfile</strong> – The output file name.</p></li>
<li><p><strong>name</strong> – The string to be used as fourth column.</p></li>
<li><p><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed_3p_end</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;199&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;200&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.write_bed_5p_end">
<span class="sig-name descname"><span class="pre">write_bed_5p_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bed6'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_bed_5p_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the 5p end coordinates of feature in bed format (Zero-based).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputfile</strong> – the output file.</p></li>
<li><p><strong>name</strong> – The keys that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>format</strong> – Format should be one of ‘bed/bed6’ or ‘bed3’. Default to bed6.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_bed_5p_end</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;99&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;100&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.Feature.write_gtf_to_bed6">
<span class="sig-name descname"><span class="pre">write_gtf_to_bed6</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('transcript_id',</span> <span class="pre">'gene_id')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'|'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_feature_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.Feature.write_gtf_to_bed6" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the Feature instance in bed format (Zero-based). Select the
key/values to add as a name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The keys that should be used to computed the ‘name’ column.</p></li>
<li><p><strong>sep</strong> – The separator used for the name (e.g ‘gene_id|transcript_id”.</p></li>
<li><p><strong>add_feature_type</strong> – Add the feature type to the name.</p></li>
<li><p><strong>outputfile</strong> – the file object were data should be printed.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span>  <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span><span class="o">.</span><span class="n">write_gtf_to_bed6</span><span class="p">(</span><span class="n">outputfile</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">):</span> <span class="n">line</span><span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g1t1|g1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.Line.FieldSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.Line.</span></span><span class="sig-name descname"><span class="pre">FieldSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ft_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representating a set of Fields obtained from a splitted line.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.FieldSet.format">
<span class="sig-name descname"><span class="pre">format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tabulated string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>separator</strong> – output field separator.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="kn">import</span> <span class="n">FieldSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;456&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">format</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">TAB</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.Line.FieldSet.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.Line.FieldSet.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write FieldSet to a file or stdout (if file is None).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>separator</strong> – output field separator.</p></li>
<li><p><strong>file_out</strong> – output file object.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.Line</span> <span class="kn">import</span> <span class="n">FieldSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">simple_nb_column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FieldSet</span><span class="p">(</span><span class="n">alist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;456&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_nb_column</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-pygtftk.stats.intersect.overlap_stats_shuffling">
<span id="the-pygtftk-stats-intersect-overlap-stats-shuffling-module"></span><h2>The pygtftk.stats.intersect.overlap_stats_shuffling module<a class="headerlink" href="#module-pygtftk.stats.intersect.overlap_stats_shuffling" title="Permalink to this headline">¶</a></h2>
<p>This is the main function to compute random shuffles to assess statistical
significance overlap of two sets of genomic regions, provided as BED files.</p>
<p>Called directly by the ologram.py plugin. All other functions calls descend from
this one.</p>
<p>Author : Quentin Ferré &lt;<a class="reference external" href="mailto:quentin&#46;q&#46;ferre&#37;&#52;&#48;gmail&#46;com">quentin<span>&#46;</span>q<span>&#46;</span>ferre<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_shuffling.ComputingIntersectionPartial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_shuffling.</span></span><span class="sig-name descname"><span class="pre">ComputingIntersectionPartial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Lr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Li1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_chrom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_chrom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_markov_shuffling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_intact_in_shuffling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_threads</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_shuffling.ComputingIntersectionPartial" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a replacer for a wrapper for compute_all_intersections_minibatch, needed for multiprocessing below
This was needed because the argument that changes in multiproessing in minibatch_len, and it’s not the leftmost argument, 
so functools.partial cannot be used</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_shuffling.compute_all_intersections_minibatch">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_shuffling.</span></span><span class="sig-name descname"><span class="pre">compute_all_intersections_minibatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Lr1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Li1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_chrom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_chrom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_markov_shuffling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_intact_in_shuffling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_threads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_shuffling.compute_all_intersections_minibatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Main processing function. Computes a minibatch of shuffles for the given parameters.</p>
<p>This function will be called by the hub function <cite>compute_overlap_stats</cite> to
create a batch of shuffled “fake” BED files.
The Lrs and Li and all_chroms are all outputs from the
bed_to_lists_of_intervals() function calls : those are the lists of region
lengths, inter-region lengths, and chromosomes for each of the two input files.</p>
<p>Lrs and Lis are lists containing [Lr2] and [Li2] if there is only one query
set, but can contain [Lr2, Lr3, …] if there is more than one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Lr1</strong> – An output from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>Li1</strong> – An output from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>Lrs</strong> – A list of outputs from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>Lis</strong> – A list of outputs from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>all_chrom1</strong> – An output from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>all_chrom2</strong> – An output from the bed_to_lists_of_intervals() function calls.</p></li>
<li><p><strong>minibatch_size</strong> – The size of the batchs for shuffling.</p></li>
<li><p><strong>use_markov_shuffling</strong> – Use a classical or a order-2 Markov shuffling.</p></li>
<li><p><strong>keep_intact_in_shuffling</strong> – Among the Lrs (and Lis), those whose number/order is here will be kept intact during the shuffling (won’t be shuffled)</p></li>
<li><p><strong>nb_threads</strong> – number of threads.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_shuffling.compute_overlap_stats">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_shuffling.</span></span><span class="sig-name descname"><span class="pre">compute_overlap_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bedA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bedsB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrom_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_nb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bed_excl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_markov_shuffling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_intact_in_shuffling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_threads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ft_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_overlap_target_combi_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_overlap_max_number_of_combinations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_overlap_custom_combis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_histogram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_shuffling.compute_overlap_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the hub function to compute overlap statistics through Monte Carlo
shuffling with integration of the inter-region lengths.</p>
<p>The function will generate shuffled BEDs from bedA and bedB independantly,
and compute intersections between those shuffles. As such, it gives an
estimation of the intersections under the null hypothesis (the sets of
regions given in A and B are independant).</p>
<p>Author : Quentin FERRE &lt;<a class="reference external" href="mailto:quentin&#46;q&#46;ferre&#37;&#52;&#48;gmail&#46;com">quentin<span>&#46;</span>q<span>&#46;</span>ferre<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bedA</strong> – The first bed file in pybedtools.Bedtool format.</p></li>
<li><p><strong>bedsB</strong> – The second bed file. Can also be a list of bed files for multiple overlaps.</p></li>
<li><p><strong>chrom_len</strong> – the dictionary of chromosome lengths</p></li>
<li><p><strong>minibatch_size</strong> – the size of the minibatch for shuffling.</p></li>
<li><p><strong>minibatch_nb</strong> – The number of minibatchs.</p></li>
<li><p><strong>bed_excl</strong> – The regions to be excluded.</p></li>
<li><p><strong>use_markov_shuffling</strong> – Use a classical or a order-2 Markov shuffling.</p></li>
<li><p><strong>keep_intact_in_shuffling</strong> – those numbers in bedsB will be kept intact/fixed during the shuffliing</p></li>
<li><p><strong>nb_threads</strong> – Number of threads.</p></li>
<li><p><strong>ft_type</strong> – The name of the feature.</p></li>
<li><p><strong>multiple_overlap_target_combi_size</strong> – For multiple overlaps, maximum number of sets in the output combinations.</p></li>
<li><p><strong>multiple_overlap_max_number_of_combinations</strong> – For multiple overlaps, maximum number of combinations to consider. This will use the MOLD mining algorithm. Do not ask for too many.</p></li>
<li><p><strong>multiple_overlap_custom_combis</strong> – For multiple overlaps, skips combination mining and computes stats directly for these combinations. Path to a file to be read as NumPy matrix.</p></li>
<li><p><strong>draw_histogram</strong> – if True, draws a temp file histogram for each combi</p></li>
<li><p><strong>exact</strong> – if True, when performing the statistics, an observation of A+B+C counts as an observation of A+B</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygtftk.stats.intersect.overlap_stats_compute">
<span id="the-pygtftk-stats-intersect-overlap-stats-compute-module"></span><h2>The pygtftk.stats.intersect.overlap_stats_compute module<a class="headerlink" href="#module-pygtftk.stats.intersect.overlap_stats_compute" title="Permalink to this headline">¶</a></h2>
<p>Compute overlap statistics on shuffled sets.
Called by overap_stats_shuffling.compute_overlap_stats(), hence the name.</p>
<p>Those functions tend to take as input lists of shuffles and output statistics.</p>
<p>Author : Quentin Ferré &lt;<a class="reference external" href="mailto:quentin&#46;q&#46;ferre&#37;&#52;&#48;gmail&#46;com">quentin<span>&#46;</span>q<span>&#46;</span>ferre<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.CombinationExactMapping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">CombinationExactMapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_combis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.CombinationExactMapping" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper containing a list of all combinations and a vector giving, for each
combination, the ID of all other combinations that are a match for it.</p>
<p>For example, if working with inexact combinations, [1,1,1] is a match when querying [1,1,0]</p>
<p>This is done to save RAM when working with very long combinations.</p>
<p>Example :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">all_combis</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):[</span><span class="mi">1</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">CombinationExactMapping</span><span class="p">(</span><span class="n">all_combis</span><span class="p">,</span> <span class="n">mapping</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_all</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_all</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="p">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.Counter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">Counter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.Counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing-compatible counter that can be incremented.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.DictionaryWithIndex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">DictionaryWithIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_default_factory=&lt;function</span> <span class="pre">DictionaryWithIndex.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">will_store_an_all_overlaps_object=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.DictionaryWithIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper allowing to query a dictionary so that an item can also return values from several other items.
The dictionary will return concatenated values from several keys when asked for.</p>
<p>It will return values from itself PLUS everything in the index</p>
<p>Specifically designed for lists of overlaps in OLOGRAM-MODL, meaning
the final result will be a list with the same number elements, whose i-th element for i in 1..n
will be the concatenated i-th elements of all candidate lists</p>
<p>Example :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">all_combis</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">CombinationExactMapping</span><span class="p">(</span><span class="n">all_combis</span><span class="p">,</span> <span class="n">mapping</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;A&#39;</span><span class="p">:[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;B&#39;</span><span class="p">:[[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">:[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">]]</span> <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">di</span> <span class="o">=</span> <span class="n">DictionaryWithIndex</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">di</span><span class="o">.</span><span class="n">get_all</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">di</span><span class="o">.</span><span class="n">get_all</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.DictionaryWithIndex.get_simple_concatenation">
<span class="sig-name descname"><span class="pre">get_simple_concatenation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.DictionaryWithIndex.get_simple_concatenation" title="Permalink to this definition">¶</a></dt>
<dd><p>For the true overlaps. Do not merge individual shuffles, there are no shuffles to be merged.
Simply concatenate the lists.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.HashableArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">HashableArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.HashableArray" title="Permalink to this definition">¶</a></dt>
<dd><p>A subclass of NumPy’s ndarray that can be used as dictionary key.
A dictionary of such arrays will consume less RAM than a tuple, especially when pickled.</p>
<p>This is however immutable, and should not be used on arrays that you intend to modify.</p>
<p>NOTE It is hashed at creation, so creation can take a bit of time.
Use a tuple if that is unacceptable.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.SparseListOfLists">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">SparseListOfLists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starting_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.SparseListOfLists" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Container for a list of this type :</dt><dd><dl class="simple">
<dt>[</dt><dd><p>[elements], [], [], [], [other_elements], [], [], …</p>
</dd>
</dl>
<p>]</p>
</dd>
</dl>
<p>Meaning, a list of lists where many of the lists inside will be empty.
This helps save RAM.</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">SparseListOfLists</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">put</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">put</span><span class="p">([</span><span class="s1">&#39;Hello&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">put</span><span class="p">([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span> <span class="o">==</span> <span class="p">[[],[</span><span class="s1">&#39;Hello&#39;</span><span class="p">],[]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;Hello&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ha&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ho&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span> <span class="o">==</span> <span class="p">[[</span><span class="s1">&#39;Ha&#39;</span><span class="p">],[</span><span class="s1">&#39;Ho&#39;</span><span class="p">],[]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.SparseListOfLists.put">
<span class="sig-name descname"><span class="pre">put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.SparseListOfLists.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an element at the tail of the SparseListOfLists</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.compute_stats_for_intersection">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">compute_stats_for_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">myintersect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.compute_stats_for_intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to compute all stats we want on a single intersect result object.
The argument (myintersect) is a single bedfile, either as a pybedtools intersect
result, or a list of tuples/lists like [[‘chr1’,10,20],[‘chr2’,30,40]].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.compute_true_intersection">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">compute_true_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bedA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bedsB</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.compute_true_intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the custom-computed true intersection between bedA and all in bedsB combined, where
bedA is a pybedtools.BedTool object and bedsB is a list of such objects.</p>
<p>Returns also the intersection flags.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.get_index_if_present">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">get_index_if_present</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mylist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.get_index_if_present" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the leftmost value exactly equal to x in a sorted list, otherwise returns None</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">get_index_if_present</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">get_index_if_present</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="kc">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.get_items_by_indices_in_list">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">get_items_by_indices_in_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mylist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.get_items_by_indices_in_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick way to perform multiple indexing on a list.
Unlike the operator.itemgetter method, will always return a list</p>
<p>Example:
&gt;&gt;&gt; assert get_items_by_indices_in_list(indices = [0], mylist = [1,2,3]) == [1]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.index_all_these">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">index_all_these</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">combis_to_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.index_all_these" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to run the global numpy analogue of 
which_combis_to_get_from on a list of combis.</p>
<p>This is not a pure function and relies on several external parameters
that will be named as globals later, before this function is called.
Those parameters are stored in the “dummy” module.</p>
<p>NOTE : the oc.NPARRAY_which_combis_match_with already integrates a check
and will not return the same index as the query</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.merge_consecutive_intersections_in_all_overlaps_lists">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">merge_consecutive_intersections_in_all_overlaps_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aiqc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.merge_consecutive_intersections_in_all_overlaps_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges the consecutive intersections in a list-of-intersection-batches object.</p>
<p>This is an in-place operation: it will not return a new list, but change the original !</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">all_intersections_queried_for_this_combi</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">),(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">),(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">)],</span> <span class="p">[(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">),(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">),(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">700</span><span class="p">)],</span> <span class="p">[(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">),(</span><span class="sa">b</span><span class="s1">&#39;chr2&#39;</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">)]</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">300</span><span class="p">)],</span> <span class="p">[(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">),(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">700</span><span class="p">)],</span> <span class="p">[(</span><span class="sa">b</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">),(</span><span class="sa">b</span><span class="s1">&#39;chr2&#39;</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">)]</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">merge_consecutive_intersections_in_all_overlaps_lists</span><span class="p">(</span><span class="n">all_intersections_queried_for_this_combi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">all_intersections_queried_for_this_combi</span> <span class="o">==</span> <span class="n">expected</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.merge_consecutive_intersections_in_intersections_list">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">merge_consecutive_intersections_in_intersections_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inter_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.merge_consecutive_intersections_in_intersections_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges the consecutive intersections in a list-of-intersections object.</p>
<p>Note that this will discard the flags (4th element, np array) and any other element in the list of lists.</p>
<p>This is NOT an in-place operation, and returns the new list.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.stats_multiple_overlap">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">stats_multiple_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_overlaps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bedA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bedsB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_feature_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nofit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_overlap_target_combi_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_overlap_max_number_of_combinations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_overlap_custom_combis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_histogram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.stats_multiple_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Instead of returning one set of overlap stats per query type (ie. exons, gens, bedfile1, bedfile2, etc…)
it will return one per multiple overlap (ie. here there was a peak for bedfile1+gene, or bedfile1+bedfile2+gene, etc.)</p>
<p>Only do so for “common/interesting combis”, found by dict learning on original data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_overlaps</strong> – The list of all overlaps computed for all shuffles</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.stats_single">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">stats_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_intersections_for_this_combi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_intersection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ft_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'some</span> <span class="pre">feature'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nofit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">this_combi_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_histogram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.stats_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute statistics such as total number of overlapping base pairs for a given feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>intersections_for_this_combi</strong> – an object returned by compute_all_intersections_minibatch giving all intersections between the shuffled bedA and bedsB.</p></li>
<li><p><strong>true_intersection</strong> – the result of overlap_stats_compute.compute_true_intersection(bedA, bedsB) where bedA is the query and bedB is the list of the bed files between whose shuffles the aforementioned intersections have been computed. Used here to calculate the true intersections between them and calculate a Neg Binom p-value.</p></li>
<li><p><strong>ft_type</strong> – for debug messages, which feature/combi are we currently processing ?</p></li>
<li><p><strong>nofit</strong> – if True, does not do Negative Binomial fitting</p></li>
<li><p><strong>this_combi_only</strong> – a list of flags (e.g. [1,0,0,1]) corresponding to expected flags in the intersections, one per file (see find_intersection() source and documentation). If not None, we will consider only intersections that have this flag for the number of true intersections and true overlapping basepairs</p></li>
<li><p><strong>draw_histogram</strong> – if True, draws a temp file histogram for each combi</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.overlap_stats_compute.which_combis_to_get_from">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.overlap_stats_compute.</span></span><span class="sig-name descname"><span class="pre">which_combis_to_get_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">combi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_possible_combis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.overlap_stats_compute.which_combis_to_get_from" title="Permalink to this definition">¶</a></dt>
<dd><p>To build an index later, determine the supplementary combis : meaning, for each
combination, which other combinations needs to be queried.</p>
<p>Relevant if we desire inexact or exact combis;
Reminded : a combi A is a “inexact” match for combi B if all flags of combi B
are also present in combi A, along with potentially others.</p>
<p>Returns an index giving the supplementary combinations.</p>
<p>Example :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">all_combis</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">which_combis_to_get_from</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">all_combis</span><span class="p">,</span> <span class="n">exact</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">r</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygtftk.stats.negbin_fit">
<span id="the-pygtftk-stats-negbin-fit-module"></span><h2>The pygtftk.stats.negbin_fit module<a class="headerlink" href="#module-pygtftk.stats.negbin_fit" title="Permalink to this headline">¶</a></h2>
<p>Contains various utility functions relative to the negative binomial distribution.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.negbin_fit.check_negbin_adjustment">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.negbin_fit.</span></span><span class="sig-name descname"><span class="pre">check_negbin_adjustment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.negbin_fit.check_negbin_adjustment" title="Permalink to this definition">¶</a></dt>
<dd><p>Considers a Negative Binomial distribution of given mean and var, and
performs an adjustement test of this distrubution with regards to obs.</p>
<p>Returns the result of a Cramer’s V adjustment test.</p>
<p>A classical Chi-squared test cannot be used, since in a typical use case
sample size will be only 250 (shuffles) and as such expected frequency for
each value will be well under 5. As such, we perform the Chi-Squared test
on an equivalent “histogram” : instead of computing the expected number
of variates exactly equal to, say, 22, we compute how many variates fall in
the 20-30 range.
Target bin number is ajustable, final bin number may vary due to rounding.</p>
<p>Futhermore, the Chi-Squared test can artificially return (H0 false) if n is
too large. Hence, we use Cramer’s V test instead.</p>
<p>The function returns 1 - V, where V is the Cramer’s V test of a crosstab
made by concatenating the observed counts and expected counts vectors.</p>
<p>The V test is here used to determine whether there is an association between
counts distribution and the status as ‘expected’ or ‘observed’.
As per Cramer (1948) a good fit should have a fit quality above 1 - 0.25 = 0.75
because V &gt; 0.25 would mean association in most cases.
Typically, you will observe good association when len(obs) is in the thousands.
When it is in the hundreds only, random chance may result in a okay-ish
association (around 0.8). Conversely, if len(obs) is in the thousands, only
fits above 0.9 should be considered good.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – Observed values.</p></li>
<li><p><strong>mean</strong> – The mean for the negative binomial model.</p></li>
<li><p><strong>var</strong> – The variance for the negative binomial model.</p></li>
<li><p><strong>bins_number</strong> – The number of bins in histogram.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.negbin_fit</span> <span class="kn">import</span> <span class="n">check_negbin_adjustment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="mi">100</span> <span class="p">;</span> <span class="n">var</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">var</span><span class="o">-</span><span class="n">mean</span><span class="p">)</span> <span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">mean</span><span class="o">/</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rv</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">nbinom</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">check_negbin_adjustment</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">fit</span> <span class="o">&gt;</span> <span class="mf">0.95</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.negbin_fit.empirical_p_val">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.negbin_fit.</span></span><span class="sig-name descname"><span class="pre">empirical_p_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.negbin_fit.empirical_p_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick wrapper : empirical two-sided p value.</p>
<p>Returns the proportion of elements greater than x (or smaller than x) in
the data (resp. whichever proportion is smaller).
This can be used with any dataset, not just a negative-binomial-compliant one.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.negbin_fit.negbin_pval">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.negbin_fit.</span></span><span class="sig-name descname"><span class="pre">negbin_pval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">320</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ft_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Unknown'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.negbin_fit.negbin_pval" title="Permalink to this definition">¶</a></dt>
<dd><p>P-value for a negative binomial distribution of the given moments (mean, var).</p>
<p>This is the two-sided p-value : it will return the minimum of the left-sided
and right-sided p-value</p>
<p>NOTE : To prevent division by zero or negative r, if the mean is higher than
or equal to the variance, set the variance to mean + epsilon and send a warning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> – the critical value for which the pvalue is computed.</p></li>
<li><p><strong>mean</strong> – The mean for the negative binomial model.</p></li>
<li><p><strong>var</strong> – The variance for the negative binomial model.</p></li>
<li><p><strong>precision</strong> – Floating point precision of mpmath. Should be at least 1000</p></li>
<li><p><strong>ft_type</strong> – The name of the feature to be tested (just for meaningful messages).</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.negbin_fit</span> <span class="kn">import</span> <span class="n">negbin_pval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="mi">18400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="mi">630200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">65630</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pval</span> <span class="o">=</span> <span class="n">negbin_pval</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">pval</span><span class="p">,</span><span class="mf">1.1999432787236828e-307</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygtftk.stats.beta">
<span id="the-pygtftk-stats-beta-module"></span><h2>The pygtftk.stats.beta module<a class="headerlink" href="#module-pygtftk.stats.beta" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.beta.BetaCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.beta.</span></span><span class="sig-name descname"><span class="pre">BetaCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">320</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ft_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Unknown'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.beta.BetaCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing the beta distribution in Python using mpmath.</p>
<p>Using routines from the GNU Scientific Library (<cite>beta_inc.c</cite>):
&lt;Copyright (C) 2007 Brian Gough and Copyright (C) 1996, 1997, 1998, 1999, 2000 Gerard Jungman&gt;</p>
<p>Available under the GNU GPL v3 license.</p>
<dl class="simple">
<dt>Formulas :</dt><dd><p>self.betainc(A, B, p) &lt;–&gt;
mpmath.betainc(A, B, 0, p) &lt;–&gt;
mpmath.quad(lambdat: t**(A-1)*(1-t)**(B-1), [0, p])</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.beta</span> <span class="kn">import</span> <span class="n">BetaCalculator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mpmath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mycalc</span> <span class="o">=</span> <span class="n">BetaCalculator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res_A</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mpmath</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res_B</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mycalc</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">res_A</span> <span class="o">==</span> <span class="n">res_B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res_A</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mpmath</span><span class="o">.</span><span class="n">betainc</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">x2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res_B</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mycalc</span><span class="o">.</span><span class="n">betainc</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">res_A</span> <span class="o">==</span> <span class="n">res_B</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.beta.BetaCalculator.beta">
<span class="sig-name descname"><span class="pre">beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.beta.BetaCalculator.beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses either mpmath’s gamma or log-gamma function to compute values of the beta function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.beta.BetaCalculator.betainc">
<span class="sig-name descname"><span class="pre">betainc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.beta.BetaCalculator.betainc" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-regularized incomplete beta. See betaincreg().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.beta.BetaCalculator.betaincreg">
<span class="sig-name descname"><span class="pre">betaincreg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.beta.BetaCalculator.betaincreg" title="Permalink to this definition">¶</a></dt>
<dd><p>betaincreg(a,b,x) evaluates the incomplete beta function (regularized).
It requires a, b &gt; 0 and 0 &lt;= x &lt;= 1.</p>
<p>Code translated from: GNU Scientific Library</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.beta.BetaCalculator.contfractbeta">
<span class="sig-name descname"><span class="pre">contfractbeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.beta.BetaCalculator.contfractbeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the continued fraction form of the incomplete Beta function.</p>
<p>Code translated from: GNU Scientific Library</p>
<p>Uses the modified Lentz’s method.</p>
<p>You can see a representation of this form in the Digial Library of
Mathematical functions &lt;<a class="reference external" href="https://dlmf.nist.gov/8.17#SS5.p1">https://dlmf.nist.gov/8.17#SS5.p1</a>&gt;.
The goal of the method is to calculate the successive ‘d’ terms,
separately for odd and even.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.beta.beta_pval">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.beta.</span></span><span class="sig-name descname"><span class="pre">beta_pval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">320</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.beta.beta_pval" title="Permalink to this definition">¶</a></dt>
<dd><p>P-value for the given critical value against a beta distribution fitted to
the given list of observations.</p>
<p>This is the two-sided p-value : it will return the minimum of the left-sided
and right-sided p-value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> – the critical value whose p-value will be calculated</p></li>
<li><p><strong>obs</strong> – the list of observations to which the beta distribution will be fitted</p></li>
<li><p><strong>precision</strong> – Floating point precision of mpmath. Should be at least 1000</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.beta</span> <span class="kn">import</span> <span class="n">beta_pval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy.testing</span> <span class="k">as</span> <span class="nn">npt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">beta</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phat</span> <span class="o">=</span> <span class="n">beta_pval</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>                        <span class="c1"># Test the combined package</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.9999</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cp</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mybetacalc</span> <span class="o">=</span> <span class="n">BetaCalculator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cphat</span> <span class="o">=</span> <span class="n">mybetacalc</span><span class="o">.</span><span class="n">betaincreg</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>    <span class="c1"># Test just the p-value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npt</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">phat</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>          <span class="c1"># Beta approximation is too imprecise for extreme p-values, however.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npt</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">cp</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">cphat</span><span class="p">),</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.beta.fit_beta">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.beta.</span></span><span class="sig-name descname"><span class="pre">fit_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.beta.fit_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a four-parameter Beta distribution to the given list of observations
using method-of-moments fitting.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy.testing</span> <span class="k">as</span> <span class="nn">npt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.beta</span> <span class="kn">import</span> <span class="n">fit_beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>  <span class="c1"># You need at least 10K for a good estimate (!)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ahat</span><span class="p">,</span> <span class="n">bhat</span><span class="p">,</span> <span class="n">mhat</span><span class="p">,</span> <span class="n">chat</span> <span class="o">=</span> <span class="n">fit_beta</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npt</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">((</span><span class="n">ahat</span><span class="p">,</span> <span class="n">bhat</span><span class="p">),</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),</span> <span class="n">rtol</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygtftk.stats.intersect.modl.tree">
<span id="the-pygtftk-stats-intersect-modl-tree-module"></span><h2>The pygtftk.stats.intersect.modl.tree module<a class="headerlink" href="#module-pygtftk.stats.intersect.modl.tree" title="Permalink to this headline">¶</a></h2>
<p>A tree (or more accurately, graph) based representation of combinations of elements.</p>
<p>Combinations are represented as tuples. For example, if the possible elements are {A,B,C,D}, the combination A+C is represented as (1,0,1,0).</p>
<p>Nodes will be assigned under the following principle : each node X that contains all flags of a node Y.
For example, (1,0,0) is a parent of (1,0,1) but not the other way around.</p>
<p>A Library is a set set of nodes starting with a root of (0,0,0,…)</p>
<p>Author : Quentin Ferré &lt;<a class="reference external" href="mailto:quentin&#46;q&#46;ferre&#37;&#52;&#48;gmail&#46;com">quentin<span>&#46;</span>q<span>&#46;</span>ferre<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.tree.Library">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.tree.</span></span><span class="sig-name descname"><span class="pre">Library</span></span><a class="headerlink" href="#pygtftk.stats.intersect.modl.tree.Library" title="Permalink to this definition">¶</a></dt>
<dd><p>A tree (or more accurately, graph) based representation of combinations of elements.</p>
<p>Combinations are represented as tuples. For example, if the possible elements are {A,B,C,D}, the combination A+C is represented as (1,0,1,0).</p>
<p>Nodes will be assigned under the following principle : each node X that contains all flags of a node Y.
For example, (1,0,0) is a parent of (1,0,1) but not the other way around.</p>
<p>A Library is a set set of nodes starting with a root of (0,0,0,…)</p>
<p>Example of use :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl.tree</span> <span class="kn">import</span> <span class="n">Library</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">words</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">Library</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">build_nodes_for_words</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">assign_nodes</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.tree.Library.build_nodes_for_words">
<span class="sig-name descname"><span class="pre">build_nodes_for_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">words</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.tree.Library.build_nodes_for_words" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds unassigned nodes for all words.</p>
<p><cite>words</cite> must be a list of tuples like [(1,0,0),(1,1,0)]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.tree.Library.build_nodes_for_words_from_ologram_result_df">
<span class="sig-name descname"><span class="pre">build_nodes_for_words_from_ologram_result_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Query'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.tree.Library.build_nodes_for_words_from_ologram_result_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for graphical display later on</p>
<p>The nodes should also have a pval and fc and s that can be given and that we can query later on
So the build_nodes_for_words function can also take a pandas dataframe that is an OLOGRAM output !!</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.tree.Node">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.tree.</span></span><span class="sig-name descname"><span class="pre">Node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">word</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.tree.Node" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a node of the tree. Each node is a word. 
A word must be a tuple such as (1,1,0,0) meaning A+B if the possibilities are {A,B,C,D}</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.tree.apply_recursively_to_all_nodes">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.tree.</span></span><span class="sig-name descname"><span class="pre">apply_recursively_to_all_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_duplicates=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_condition=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.tree.apply_recursively_to_all_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>General utility function to recursively apply a function to all nodes of a tree.
Also pass a global_results dict to be added to.</p>
<p>Since nodes can have several parents, by default this will remember which nodes
have been seen and not operate on them twice (<cite>no_duplicates</cite>).</p>
<p>A stop condition fonction of signature stop_condition(current_node, global_results)
can be passed : the recursion will stop if it returns True at any point.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl.tree</span> <span class="kn">import</span> <span class="n">Library</span><span class="p">,</span> <span class="n">apply_recursively_to_all_nodes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utils</span><span class="o">.</span><span class="n">VERBOSITY</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">words</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">Library</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">build_nodes_for_words</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">assign_nodes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manual_print_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">assigned_nodes</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apply_recursively_to_all_nodes</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">root_node</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">gr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recursive_print_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">recursive_print_words</span> <span class="o">==</span> <span class="n">manual_print_words</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.tree.get_all_candidates_except">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.tree.</span></span><span class="sig-name descname"><span class="pre">get_all_candidates_except</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">library</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.tree.get_all_candidates_except" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the words of all nodes, except those words that are in the exclusion list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.tree.output_visualize">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.tree.</span></span><span class="sig-name descname"><span class="pre">output_visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.tree.output_visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a visualisation a a given Library (the <cite>tree</cite> argument)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> – : The library to write</p></li>
<li><p><strong>output_path</strong> – Path to write to</p></li>
<li><p><strong>features_names</strong> – Conversion key giving the name of each feature in the vector. For example if features_names = [‘A’,’B’,’C’], (0,1,1) will be translated as B+C</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pygtftk.stats.intersect.modl.dict_learning">
<span id="the-pygtftk-stats-intersect-modl-dict-learning-module"></span><h2>The pygtftk.stats.intersect.modl.dict_learning module<a class="headerlink" href="#module-pygtftk.stats.intersect.modl.dict_learning" title="Permalink to this headline">¶</a></h2>
<p>This module contains the MODL algorithm, an itemset mining algorithm that broadly consists of two steps.</p>
<p>Considering an input matrix with transactions/regions.intersections in lines and
elements/items/sets in columns, the algorithm will : (I) learn (MiniBatchDictionaryLearning)
several factorisations with different sparsity constraints to build a library of
candidate words (eg. (1,1,0,0,1)) and (II) select the best words to rebuild the 
original matrix using a greedy algorithm, by trying to rebuild the original 
matrix with a subset of selected words, adding the word that best improves the 
rebuilding to said subset each time.</p>
<p>Dictionary learning is an optimization problem solved by alternatively updating the 
sparse code, as a solution to multiple Lasso problems, considering the dictionary fixed,
and then updating the dictionary to best fit the sparse code.</p>
<p>In OLOGRAM, we use this on the matrix of true overlap flags to find usual common overlaps.</p>
<p>This is mostly useful if there are many files to reduce the number of displayed combinations,
and to counteract the effect of noise on the data. Unlike classical association
rules mining algorithms, this focuses on mining complexes and correlation groups (item sets).</p>
<p>Author : Quentin FERRE &lt;<a class="reference external" href="mailto:quentin&#46;q&#46;ferre&#37;&#52;&#48;gmail&#46;com">quentin<span>&#46;</span>q<span>&#46;</span>ferre<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p>This code is available under the GNU GPL license.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.dict_learning.Modl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.dict_learning.</span></span><span class="sig-name descname"><span class="pre">Modl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_overlap_target_combi_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple_overlap_max_number_of_combinations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_1_factor_allowance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smother</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_words</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_2_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discretization_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_1_alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.dict_learning.Modl" title="Permalink to this definition">¶</a></dt>
<dd><p>This class encapsulates the MODL approach :</p>
<p>Takes as input a matrix of flags, with one flag per intersection,
and returns the list of interesting combis.</p>
<p>For more details, please see the module description of pygtftk/stats/intersect/modl/dict_learning.py</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags_matrix</strong> – Matrix of overlaps</p></li>
<li><p><strong>multiple_overlap_target_combi_size</strong> – Candidates longer than this will be discarded</p></li>
<li><p><strong>multiple_overlap_max_number_of_combinations</strong> – Final desired number of combinations</p></li>
<li><p><strong>nb_threads</strong> – Number of threads</p></li>
<li><p><strong>step_1_factor_allowance</strong> – In step 1 of building the candidates, how many words are allowed in the Dictionary Learning as a proportion of multiple_overlap_max_number_of_combinations</p></li>
<li><p><strong>error_function</strong> – error function used in step 2. Default to manhattan error.</p></li>
<li><p><strong>smother</strong> – Should the smothering which reduces each row’s abudane to its square root to emphasize rarer combinations be applied ? Default is True</p></li>
<li><p><strong>normalize_words</strong> – Normalize the words by their summed squares in step 2. Default True.</p></li>
<li><p><strong>step_2_alpha</strong> – Override the alpha used in step 2.</p></li>
<li><p><strong>discretization_threshold</strong> – discretization_threshold in step 1. In each atom, elements below D*maximum_for_this_atom will be discarded. Optional.</p></li>
<li><p><strong>step_1_alphas</strong> – A list to manually override the alphas to be used during step 1. Optional.</p></li>
</ul>
</dd>
</dl>
<p>Passing a custom error function, it must have the signature error_function(X_true, X_rebuilt, encoded, dictionary). 
X_true is the real data, X_rebuilt is the reconstruction to evaluate, code is the encoded version (in our case used 
to check sparsity), dictionary has one learned atom per row.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl.dict_learning</span> <span class="kn">import</span> <span class="n">Modl</span><span class="p">,</span> <span class="n">test_data_for_modl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_matrix</span> <span class="o">=</span> <span class="n">test_data_for_modl</span><span class="p">(</span><span class="n">nflags</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">number_of_sets</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">noise</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">cor_groups</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combi_miner</span> <span class="o">=</span> <span class="n">Modl</span><span class="p">(</span><span class="n">flags_matrix</span><span class="p">,</span> <span class="n">multiple_overlap_max_number_of_combinations</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interesting_combis</span> <span class="o">=</span> <span class="n">combi_miner</span><span class="o">.</span><span class="n">find_interesting_combinations</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">interesting_combis</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.dict_learning.Modl.find_interesting_combinations">
<span class="sig-name descname"><span class="pre">find_interesting_combinations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.dict_learning.Modl.find_interesting_combinations" title="Permalink to this definition">¶</a></dt>
<dd><p>MAIN FUNCTION. Will call the others.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.dict_learning.Modl.generate_candidate_words">
<span class="sig-name descname"><span class="pre">generate_candidate_words</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.dict_learning.Modl.generate_candidate_words" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the library by running dictionary-learning based matrix factorizations 
on the data matrix</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.dict_learning.Modl.select_best_words_from_library">
<span class="sig-name descname"><span class="pre">select_best_words_from_library</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.dict_learning.Modl.select_best_words_from_library" title="Permalink to this definition">¶</a></dt>
<dd><p>This is step 2. Takes the library of candidates produced at step 1
and will get the best N words among it that best rebuild the original matrix.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.dict_learning.squish_matrix">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.dict_learning.</span></span><span class="sig-name descname"><span class="pre">squish_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abundance_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smother</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.dict_learning.squish_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>To reduce redundancy in the matrix lines, take all unique rows of X and 
build a squished matrix where each line now has the square root of its 
original abundance divided by sqrt(abundance of most rate), but not lower 
than abundance_threshold, 1/10000 by default. We use the square root of 
those abudances instead to dimnish the emphasis on the most frequent 
combinations by default (smothering).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl.dict_learning</span> <span class="kn">import</span> <span class="n">squish_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_squished</span> <span class="o">=</span> <span class="n">squish_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">smother</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_equal</span><span class="p">(</span><span class="n">X_squished</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">1</span> <span class="o">+</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># Note that the rows have been sorted by abundance   </span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.dict_learning.test_data_for_modl">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.dict_learning.</span></span><span class="sig-name descname"><span class="pre">test_data_for_modl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_sets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(0,</span> <span class="pre">1),</span> <span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3),</span> <span class="pre">(4,</span> <span class="pre">5)]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.dict_learning.test_data_for_modl" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate testing data for the dictionary learning module.</p>
</dd></dl>

</section>
<section id="module-pygtftk.stats.intersect.modl.subroutines">
<span id="the-pygtftk-stats-intersect-modl-subroutines-module"></span><h2>The pygtftk.stats.intersect.modl.subroutines module<a class="headerlink" href="#module-pygtftk.stats.intersect.modl.subroutines" title="Permalink to this headline">¶</a></h2>
<p>Pure subroutines of the MODL algorithm.</p>
<p>Author : Quentin Ferré &lt;<a class="reference external" href="mailto:quentin&#46;q&#46;ferre&#37;&#52;&#48;gmail&#46;com">quentin<span>&#46;</span>q<span>&#46;</span>ferre<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.subroutines.build_best_dict_from_library">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.subroutines.</span></span><span class="sig-name descname"><span class="pre">build_best_dict_from_library</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">library</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queried_words_nb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_words</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.subroutines.build_best_dict_from_library" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a data matrix and a library, will select the best n = queried_words_nb words
with a greedy algorithm from the library to rebuild the data.</p>
<p><cite>data</cite> is a matrix with one transaction per row and one element per column, as usual</p>
<p>The greeedy algorithm works because the problem in this particular instance
is submodular. In broad strokes, it is assumed that the gain in term of reconstruction
with the Sparse Coder of adding the word X to a set S is no higher than adding X to a
set T that contains S. Also, more words cannot make the sparse coder do a worse job so
the function is monotonous.</p>
<p>Instead of the reconstruction error, you may pass a different callable of the form
error_function(data, rebuilt_data, encoded, dictionary) that returns an error value so there
can be a supervision, but the submodularity might no longer hold.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl</span> <span class="kn">import</span> <span class="n">subroutines</span> <span class="k">as</span> <span class="n">modl_subroutines</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">candidates</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="o">.</span><span class="n">build_nodes_for_words</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="o">.</span><span class="n">assign_nodes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selection</span> <span class="o">=</span> <span class="n">modl_subroutines</span><span class="o">.</span><span class="n">build_best_dict_from_library</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">queried_words_nb</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.subroutines.generate_candidate_words">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.subroutines.</span></span><span class="sig-name descname"><span class="pre">generate_candidate_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_words</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discretization_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.subroutines.generate_candidate_words" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a data matrix, will generate a library of candidate words by trying many
different Dictionary Learnings (different alphas only for now)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.subroutines.learn_dictionary_and_encode">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.subroutines.</span></span><span class="sig-name descname"><span class="pre">learn_dictionary_and_encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lasso_cd'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.subroutines.learn_dictionary_and_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Will learn a dictionary for the data (row-wise) and encode it, with the specified parameters.
Returns the dictionary, components as a dataframe, and encoded data.</p>
<p>By default, allows 20 words with alpha of 0.5.</p>
<p>More info at : <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.MiniBatchDictionaryLearning.html">https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.MiniBatchDictionaryLearning.html</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl.dict_learning</span> <span class="kn">import</span> <span class="n">test_data_for_modl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl.subroutines</span> <span class="kn">import</span> <span class="n">learn_dictionary_and_encode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flags_matrix</span> <span class="o">=</span> <span class="n">test_data_for_modl</span><span class="p">(</span><span class="n">nflags</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">number_of_sets</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">U_df</span><span class="p">,</span> <span class="n">V_df</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">learn_dictionary_and_encode</span><span class="p">(</span><span class="n">flags_matrix</span><span class="p">,</span> <span class="n">n_atoms</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stop_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.stats.intersect.modl.subroutines.normalize_and_jitter_matrix_rows">
<span class="sig-prename descclassname"><span class="pre">pygtftk.stats.intersect.modl.subroutines.</span></span><span class="sig-name descname"><span class="pre">normalize_and_jitter_matrix_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.stats.intersect.modl.subroutines.normalize_and_jitter_matrix_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply normalization so that sum of suquare of each row is 1,
Add a slight epsilon so two rows may not have exact same dot product with a given vector
Sort in lexicographic order</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy.testing</span> <span class="k">as</span> <span class="nn">npt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.stats.intersect.modl.subroutines</span> <span class="kn">import</span> <span class="n">normalize_and_jitter_matrix_rows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dc</span> <span class="o">=</span> <span class="n">normalize_and_jitter_matrix_rows</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dc_theory</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.0736E-5</span><span class="p">,</span> <span class="mf">7.07107E-1</span><span class="p">,</span> <span class="mf">7.07107E-1</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.07107E-1</span><span class="p">,</span> <span class="mf">7.07107E-1</span><span class="p">,</span> <span class="mf">9.99859E-05</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npt</span><span class="o">.</span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">Dc</span><span class="p">,</span> <span class="n">Dc_theory</span><span class="p">,</span> <span class="n">decimal</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pygtftk.utils">
<span id="the-gtftk-utils-module"></span><h2>The gtftk.utils module<a class="headerlink" href="#module-pygtftk.utils" title="Permalink to this headline">¶</a></h2>
<p>A set of useful functions.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pygtftk.utils.GTFtkError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">GTFtkError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.GTFtkError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pygtftk.utils.GTFtkInteractiveError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">GTFtkInteractiveError</span></span><a class="headerlink" href="#pygtftk.utils.GTFtkInteractiveError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.add_prefix_to_file">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">add_prefix_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.add_prefix_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a file object or path (as string) in which the
base name is prefixed with ‘prefix’. Returns a file object (write mode)
or path depending on input type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> – A file object or path.</p></li>
<li><p><strong>prefix</strong> – the prefix to add.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">add_prefix_to_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;data/simple/bla_simple.gtf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">add_prefix_to_file</span><span class="p">(</span><span class="s1">&#39;data/simple/simple.gtf&#39;</span><span class="p">,</span> <span class="s2">&quot;bla_&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">result</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.check_boolean_exprs">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">check_boolean_exprs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exprs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">send_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_boolean_exprs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a boolean expression is properly formed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exprs</strong> – The string to evaluate.</p></li>
<li><p><strong>operand</strong> – The name of the operands.</p></li>
<li><p><strong>send_error</strong> – Whether to throw an error if expression is malformed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A boolean.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">check_boolean_exprs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_boolean_exprs</span><span class="p">(</span><span class="s1">&#39;s &gt; 1 and (s &lt; 2 or y &lt; 2.5)&#39;</span><span class="p">,</span> <span class="n">operand</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.check_file_or_dir_exists">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">check_file_or_dir_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_or_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_file_or_dir_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a file/directory or a list of files/directories exist. Raise error if a file is not found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_or_dir</strong> – file object or a list of file object.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">check_file_or_dir_exists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_file_or_dir_exists</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_file_or_dir_exists</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.check_r_installed">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">check_r_installed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_r_installed" title="Permalink to this definition">¶</a></dt>
<dd><p>Check R is installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">check_r_installed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># check_r_installed()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.check_r_packages">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">check_r_packages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_pkg_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.check_r_packages" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if R packages are installed. Return False otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>no_error</strong> – don’t raise an error if some packages are not found.</p></li>
<li><p><strong>r_pkg_list</strong> – the list of R packages.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">check_r_packages</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.chomp">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">chomp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete carriage return and line feed from end of string.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">chomp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">NEWLINE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">NEWLINE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chomp</span><span class="p">(</span><span class="s2">&quot;blabla</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.chrom_info_as_dict">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">chrom_info_as_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chrom_info_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chrom_info_as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the format of the chromosome info file and return a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chrom_info_file</strong> – A file object.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">chrom_info_as_dict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;chromInfo&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">chrom_info_as_dict</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;chr1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;all_chrom&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">900</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.chrom_info_to_bed_file">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">chrom_info_to_bed_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chrom_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chr_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.chrom_info_to_bed_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bed file (file object) from a chrom info file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chrom_file</strong> – A file object.</p></li>
<li><p><strong>chr_list</strong> – A list of chromosome to be printed to bed file.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">chrom_info_to_bed_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span>  <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pybedtools</span> <span class="kn">import</span>  <span class="n">BedTool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;chromInfo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">chrom_info_to_bed_file</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">BedTool</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chrs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span> <span class="n">chrs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">chrom</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s1">&#39;chr1&#39;</span> <span class="ow">in</span> <span class="n">chrs</span> <span class="ow">and</span> <span class="s1">&#39;chr2&#39;</span> <span class="ow">in</span> <span class="n">chrs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">starts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span> <span class="n">starts</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="mi">0</span> <span class="ow">in</span> <span class="n">starts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ends</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span> <span class="n">ends</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="mi">300</span> <span class="ow">in</span> <span class="n">ends</span> <span class="ow">and</span> <span class="mi">600</span> <span class="ow">in</span> <span class="n">ends</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.close_properly">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">close_properly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.close_properly" title="Permalink to this definition">¶</a></dt>
<dd><p>Close a set of file if they are not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">close_properly</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.flatten_list">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">flatten_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.flatten_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten a list of lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – a list or list of list.</p></li>
<li><p><strong>outlist</strong> – The output list.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">flatten_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Call it with an empty list (outlist)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># otherwise, element will be added to the existing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># outlist variable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">flatten_list</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">],</span> <span class="n">outlist</span><span class="o">=</span><span class="p">[])</span> <span class="o">==</span>  <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">flatten_list</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="n">outlist</span><span class="o">=</span><span class="p">[])</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;string&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.flatten_list_recur">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">flatten_list_recur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.flatten_list_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>Join a list of list.
:param a_list: a list.
:param sep: the separator.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.get_example_feature">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">get_example_feature</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.get_example_feature" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an example Feature (i.e GTF line).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_feature</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">get_example_feature</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.get_example_file">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">get_example_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasetname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'simple'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gtf'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.get_example_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path to a gtf file example located in pygtftk library path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasetname</strong> – The name of the dataset. One of ‘simple’, ‘mini_real’, ‘simple_02, ‘simple_03’.</p></li>
<li><p><strong>ext</strong> – Extension. For ‘simple’ dataset, can be one of ‘bw’, ‘fa’, ‘fa.fai’, ‘chromInfo’, ‘bt*’, ‘fq’, ‘gtf’ or ‘.*’.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;gtf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;bam&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bam&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;bw&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;bw&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.head_file">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">head_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">afile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.head_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Display the first lines of a file (debug).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>afile</strong> – an input file.</p></li>
<li><p><strong>nb_line</strong> – the number of lines to print.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">head_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">get_example_file</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#head_file(my_file)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.intervals">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of tuple that correspond to n ~ equally spaced intervals
between 0 and l. Note that n must be lower than len(l).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>silent</strong> – use a silent mode.</p></li>
<li><p><strong>l</strong> – a range</p></li>
<li><p><strong>n</strong> – number of equally spaced intervals.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">intervals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span> <span class="o">==</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.is_comment">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">is_comment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Check wether a string is a comment (starts with #…).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – The string to be tested.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">is_comment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_comment</span><span class="p">(</span><span class="s2">&quot;#bla&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.is_empty">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the string empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – The string to be tested.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">is_empty</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_empty</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.is_exon">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">is_exon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_exon" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the string contains ‘exon’ preceded or not by spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – The string to be tested.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">is_exon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_exon</span><span class="p">(</span><span class="s2">&quot;Exon&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_exon</span><span class="p">(</span><span class="s2">&quot;exon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.is_fasta_header">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">is_fasta_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.is_fasta_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the line is a fasta header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – a character string.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">is_fasta_header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">is_fasta_header</span><span class="p">(</span><span class="s2">&quot;&gt;DFTDFTD&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.make_outdir_and_file">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">make_outdir_and_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.make_outdir_and_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create output directory and a set of associated files (alist).
Return a list of file handler (write mode) for the requested files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> – the directory where file will be located.</p></li>
<li><p><strong>alist</strong> – the list of requested file names.</p></li>
<li><p><strong>force</strong> – if true, don’t abort if directory already exists.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_outdir_and_file</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.make_tmp_dir">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">make_tmp_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.make_tmp_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should be call to create a temporary file as all files
declared in TMP_FILE_LIST will be remove upon command exit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – a prefix for the temporary file (all of them will contain ‘pygtftk’).</p></li>
<li><p><strong>store</strong> – declare the temporary file in utils.TMP_FILE_LIST. In pygtftk,     the deletion of these files upon exit is controled through -k.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span>  <span class="n">make_tmp_dir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_dir</span> <span class="o">=</span> <span class="n">make_tmp_dir</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tp_dir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">tp_dir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tp_dir</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.make_tmp_file">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">make_tmp_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.make_tmp_file" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should be call to create a temporary file as all files
declared in TMP_FILE_LIST will be remove upon command exit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – a prefix for the temporary file (all of them will contain ‘pygtftk’).</p></li>
<li><p><strong>suffix</strong> – a suffix (default to ‘’).</p></li>
<li><p><strong>store</strong> – declare the temporary file in utils.TMP_FILE_LIST. In pygtftk,     the deletion of these files upon exit is controled through -k.</p></li>
<li><p><strong>dir</strong> – a target directory.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;pref&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp_file</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;suf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp_file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.median_comp">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">median_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.median_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the median from a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alist</strong> – a list.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">median_comp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">median_comp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">median_comp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">30</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.message">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INFO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a formated message on STDERR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – the message to be send.</p></li>
<li><p><strong>nl</strong> – if True, add a newline.</p></li>
<li><p><strong>type</strong> – Could be INFO, ERROR, WARNING.</p></li>
<li><p><strong>force</strong> – Force message, whatever the verbosity level.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">message</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.mkdir_p">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">mkdir_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.mkdir_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory silently if already exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">check_file_or_dir_exists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">mkdir_p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mkdir_p</span><span class="p">(</span><span class="s1">&#39;/tmp/test_gtftk_mkdir_p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">check_file_or_dir_exists</span><span class="p">(</span><span class="s1">&#39;/tmp/test_gtftk_mkdir_p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.nested_dict">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">nested_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.nested_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>“<a class="reference external" href="http://stackoverflow.com/questions/29348345">http://stackoverflow.com/questions/29348345</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.random_string">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">random_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.random_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random string (alpha numeric) of length n.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.rnd_alpha_numeric_string">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">rnd_alpha_numeric_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.rnd_alpha_numeric_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random alphanumeric string of size str_len.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>str_len</strong> – The length of the output string.</p>
</dd>
</dl>
<p>:Example :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">rnd_alpha_numeric_string</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rnd_alpha_numeric_string</span><span class="p">(</span><span class="n">str_len</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="mi">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.silentremove">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">silentremove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.silentremove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove silently (without error and warning) a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – a file name (or file object).</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">silentremove</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">make_tmp_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">make_tmp_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">silentremove</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.simple_line_count">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">simple_line_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">afile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.simple_line_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of lines in a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>afile</strong> – A file object.</p>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">simple_line_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file_h</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_line_count</span><span class="p">(</span><span class="n">my_file_h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">70</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.simple_nb_column">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">simple_nb_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">afile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.simple_nb_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the maximum number of columns in a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>separator</strong> – the separator (default ”  “).</p></li>
<li><p><strong>afile</strong> – file name.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">get_example_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">simple_nb_column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file</span> <span class="o">=</span> <span class="n">get_example_file</span><span class="p">(</span><span class="n">datasetname</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s2">&quot;gtf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_file_h</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">my_file</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">simple_nb_column</span><span class="p">(</span><span class="n">my_file_h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.sort_2_lists">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">sort_2_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.sort_2_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort list1 in increasing order and list2 occordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list1</strong> – the first list.</p></li>
<li><p><strong>list2</strong> – the second list.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">sort_2_lists</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">sort_2_lists</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c</span> <span class="o">==</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.tab_line">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">tab_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.tab_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tabulated string from an input list with an optional
newline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token</strong> – an input list.</p></li>
<li><p><strong>newline</strong> – if True a newline character is added to the string.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">tab_line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">TAB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">tab_line</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="n">TAB</span> <span class="o">+</span> <span class="s1">&#39;b&#39;</span> <span class="o">+</span> <span class="n">TAB</span> <span class="o">+</span> <span class="s1">&#39;c&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.to_alphanum">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">to_alphanum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.to_alphanum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new string in which non alphanumeric character have been replaced by ‘_’. If non alphanumeric characters
are found at the beginning or end of the string, they are deleted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> – A character string in which non alphanumeric char have to be replaced.</p>
</dd>
</dl>
<p>:Example :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">to_alphanum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">to_alphanum</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2">tf.bla&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;gtf_bla&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.to_list">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_char</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a None, str, tuple to list. May also split if required.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygtftk.utils.write_properly">
<span class="sig-prename descclassname"><span class="pre">pygtftk.utils.</span></span><span class="sig-name descname"><span class="pre">write_properly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">afile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygtftk.utils.write_properly" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a string to a file. If file is None, write string to stdout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a_string</strong> – a character string.</p></li>
<li><p><strong>afile</strong> – a file object.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pygtftk.utils</span> <span class="kn">import</span> <span class="n">write_properly</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Help on Python package (pygtftk)</a><ul>
<li><a class="reference internal" href="#module-pygtftk.gtf_interface">The GTF class</a></li>
<li><a class="reference internal" href="#module-pygtftk.fasta_interface">The FASTA class</a></li>
<li><a class="reference internal" href="#module-pygtftk.tab_interface">The TAB class</a></li>
<li><a class="reference internal" href="#module-pygtftk.Line">The Line module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.intersect.overlap_stats_shuffling">The pygtftk.stats.intersect.overlap_stats_shuffling module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.intersect.overlap_stats_compute">The pygtftk.stats.intersect.overlap_stats_compute module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.negbin_fit">The pygtftk.stats.negbin_fit module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.beta">The pygtftk.stats.beta module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.intersect.modl.tree">The pygtftk.stats.intersect.modl.tree module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.intersect.modl.dict_learning">The pygtftk.stats.intersect.modl.dict_learning module</a></li>
<li><a class="reference internal" href="#module-pygtftk.stats.intersect.modl.subroutines">The pygtftk.stats.intersect.modl.subroutines module</a></li>
<li><a class="reference internal" href="#module-pygtftk.utils">The gtftk.utils module</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="miscellaneous.html"
                          title="previous chapter">Commands from section ‘miscellaneous’</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="bwig_coverage.html"
                          title="next chapter">The pygtftk.bwig.bw_coverage module</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bwig_coverage.html" title="The pygtftk.bwig.bw_coverage module"
             >next</a> |</li>
        <li class="right" >
          <a href="miscellaneous.html" title="Commands from section ‘miscellaneous’"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">gtftk 1.6.2 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Help on Python package (pygtftk)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, F. Lopez and D. Puthier.
      Last updated on Mar 24, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>